@page "/"
@rendermode @(new Microsoft.AspNetCore.Components.Web.InteractiveServerRenderMode())

@using Table.Components
@using Table.Models

<PageTitle>Generic Data Grid Demo</PageTitle>

<div class="page-container">
    <DataGridComponent TItem="Employee"
              Items="@employees"
              Columns="@columns"
              CreateNewItem="@CreateNewEmployee"
              CloneItem="@CloneEmployee"
              OnItemSaved="@HandleItemSaved"
              OnItemDeleted="@HandleItemDeleted"
              OnItemAdded="@HandleItemAdded"
              AllowRowReorder="true"
              OrderPropertyName="DisplayOrder"
              />
</div>

@code {
    private List<Employee> employees = new();
    private List<GridColumn<Employee>> columns = new();
    private int nextId = 6;

    protected override void OnInitialized()
    {
        LoadSampleData();
        ConfigureColumns();
    }

    private void LoadSampleData()
    {
        employees = new List<Employee>
        {
            new Employee { Id = 1, DisplayOrder = 0, Name = "John Doe", Email = "john.doe@company.com", Age = 30, Department = "IT", IsActive = true, HireDate = new DateTime(2020, 1, 15), Salary = 75000, Position = "Developer", Notes = "Senior developer" },
            new Employee { Id = 2, DisplayOrder = 1, Name = "Jane Smith", Email = "jane.smith@company.com", Age = 25, Department = "HR", IsActive = true, HireDate = new DateTime(2021, 3, 10), Salary = 60000, Position = "HR Manager", Notes = "Excellent communication" },
            new Employee { Id = 3, DisplayOrder = 2, Name = "Bob Johnson", Email = "bob.johnson@company.com", Age = 35, Department = "Finance", IsActive = false, HireDate = new DateTime(2019, 7, 20), Salary = 85000, Position = "Accountant", Notes = "On leave" },
            new Employee { Id = 4, DisplayOrder = 3, Name = "Alice Williams", Email = "alice.williams@company.com", Age = 28, Department = "Marketing", IsActive = true, HireDate = new DateTime(2022, 2, 5), Salary = 65000, Position = "Marketing Lead", Notes = "Creative thinker" },
            new Employee { Id = 5, DisplayOrder = 4, Name = "Charlie Brown", Email = "charlie.brown@company.com", Age = 42, Department = "IT", IsActive = true, HireDate = new DateTime(2018, 11, 1), Salary = 95000, Position = "Tech Lead", Notes = "Team mentor" },
            new Employee { Id = 6, DisplayOrder = 5, Name = "Diana Prince", Email = "diana.prince@company.com", Age = 29, Department = "Sales", IsActive = true, HireDate = new DateTime(2021, 5, 12), Salary = 70000, Position = "Sales Manager", Notes = "Top performer" },
            new Employee { Id = 7, DisplayOrder = 6, Name = "Edward Norton", Email = "edward.norton@company.com", Age = 38, Department = "IT", IsActive = true, HireDate = new DateTime(2019, 9, 3), Salary = 88000, Position = "Senior Developer", Notes = "Full-stack expert" },
            new Employee { Id = 8, DisplayOrder = 7, Name = "Fiona Green", Email = "fiona.green@company.com", Age = 26, Department = "Marketing", IsActive = false, HireDate = new DateTime(2022, 8, 18), Salary = 55000, Position = "Marketing Specialist", Notes = "Maternity leave" },
            new Employee { Id = 9, DisplayOrder = 8, Name = "George Wilson", Email = "george.wilson@company.com", Age = 45, Department = "Finance", IsActive = true, HireDate = new DateTime(2017, 4, 7), Salary = 92000, Position = "Finance Director", Notes = "Budget specialist" },
            new Employee { Id = 10, DisplayOrder = 9, Name = "Helen Davis", Email = "helen.davis@company.com", Age = 31, Department = "HR", IsActive = true, HireDate = new DateTime(2020, 6, 22), Salary = 63000, Position = "Recruiter", Notes = "Talent acquisition" },
            new Employee { Id = 11, DisplayOrder = 10, Name = "Ian Miller", Email = "ian.miller@company.com", Age = 33, Department = "IT", IsActive = true, HireDate = new DateTime(2021, 1, 14), Salary = 79000, Position = "DevOps Engineer", Notes = "Cloud infrastructure" },
            new Employee { Id = 12, DisplayOrder = 11, Name = "Julia Roberts", Email = "julia.roberts@company.com", Age = 27, Department = "Sales", IsActive = true, HireDate = new DateTime(2022, 11, 9), Salary = 58000, Position = "Sales Representative", Notes = "New client focus" },
            new Employee { Id = 13, DisplayOrder = 12, Name = "Kevin Hart", Email = "kevin.hart@company.com", Age = 40, Department = "Marketing", IsActive = true, HireDate = new DateTime(2018, 12, 5), Salary = 72000, Position = "Brand Manager", Notes = "Social media expert" },
            new Employee { Id = 14, DisplayOrder = 13, Name = "Laura Thompson", Email = "laura.thompson@company.com", Age = 24, Department = "Finance", IsActive = true, HireDate = new DateTime(2023, 2, 1), Salary = 48000, Position = "Junior Analyst", Notes = "Recent graduate" },
            new Employee { Id = 15, DisplayOrder = 14, Name = "Michael Jackson", Email = "michael.jackson@company.com", Age = 37, Department = "IT", IsActive = false, HireDate = new DateTime(2019, 3, 15), Salary = 85000, Position = "System Administrator", Notes = "Medical leave" },
            new Employee { Id = 16, DisplayOrder = 15, Name = "Nancy Drew", Email = "nancy.drew@company.com", Age = 32, Department = "HR", IsActive = true, HireDate = new DateTime(2020, 10, 8), Salary = 67000, Position = "Training Coordinator", Notes = "Employee development" },
            new Employee { Id = 17, DisplayOrder = 16, Name = "Oscar Wilde", Email = "oscar.wilde@company.com", Age = 44, Department = "Sales", IsActive = true, HireDate = new DateTime(2016, 7, 12), Salary = 95000, Position = "Sales Director", Notes = "Regional leader" },
            new Employee { Id = 18, DisplayOrder = 17, Name = "Patricia Moore", Email = "patricia.moore@company.com", Age = 36, Department = "Marketing", IsActive = true, HireDate = new DateTime(2019, 5, 20), Salary = 74000, Position = "Content Manager", Notes = "Digital marketing" },
            new Employee { Id = 19, DisplayOrder = 18, Name = "Quincy Jones", Email = "quincy.jones@company.com", Age = 28, Department = "Finance", IsActive = true, HireDate = new DateTime(2021, 9, 3), Salary = 62000, Position = "Financial Analyst", Notes = "Investment research" },
            new Employee { Id = 20, DisplayOrder = 19, Name = "Rachel Green", Email = "rachel.green@company.com", Age = 30, Department = "IT", IsActive = true, HireDate = new DateTime(2020, 4, 16), Salary = 76000, Position = "UX Designer", Notes = "User experience focus" },
            new Employee { Id = 21, DisplayOrder = 20, Name = "Samuel Lee", Email = "samuel.lee@company.com", Age = 41, Department = "HR", IsActive = true, HireDate = new DateTime(2018, 8, 25), Salary = 78000, Position = "Benefits Administrator", Notes = "Employee wellness" },
            new Employee { Id = 22, DisplayOrder = 21, Name = "Tina Turner", Email = "tina.turner@company.com", Age = 34, Department = "Sales", IsActive = false, HireDate = new DateTime(2019, 11, 7), Salary = 68000, Position = "Account Manager", Notes = "Temporary assignment" },
            new Employee { Id = 23, DisplayOrder = 22, Name = "Ulysses Grant", Email = "ulysses.grant@company.com", Age = 39, Department = "Marketing", IsActive = true, HireDate = new DateTime(2018, 1, 10), Salary = 81000, Position = "Marketing Director", Notes = "Strategic planning" },
            new Employee { Id = 24, DisplayOrder = 23, Name = "Victoria Secret", Email = "victoria.secret@company.com", Age = 26, Department = "Finance", IsActive = true, HireDate = new DateTime(2022, 6, 14), Salary = 52000, Position = "Tax Specialist", Notes = "Compliance expert" },
            new Employee { Id = 25, DisplayOrder = 24, Name = "Walter White", Email = "walter.white@company.com", Age = 43, Department = "IT", IsActive = true, HireDate = new DateTime(2017, 10, 30), Salary = 98000, Position = "Chief Technology Officer", Notes = "Technology vision" },
            new Employee { Id = 26, DisplayOrder = 25, Name = "Xena Warrior", Email = "xena.warrior@company.com", Age = 33, Department = "HR", IsActive = true, HireDate = new DateTime(2020, 12, 4), Salary = 71000, Position = "Employee Relations", Notes = "Conflict resolution" },
            new Employee { Id = 27, DisplayOrder = 26, Name = "Yoda Master", Email = "yoda.master@company.com", Age = 35, Department = "Sales", IsActive = true, HireDate = new DateTime(2019, 2, 28), Salary = 83000, Position = "Senior Sales Rep", Notes = "Mentorship role" },
            new Employee { Id = 28, DisplayOrder = 27, Name = "Zelda Link", Email = "zelda.link@company.com", Age = 29, Department = "Marketing", IsActive = true, HireDate = new DateTime(2021, 7, 11), Salary = 66000, Position = "SEO Specialist", Notes = "Search optimization" },
            new Employee { Id = 29, DisplayOrder = 28, Name = "Arthur King", Email = "arthur.king@company.com", Age = 46, Department = "Finance", IsActive = true, HireDate = new DateTime(2016, 3, 21), Salary = 105000, Position = "Chief Financial Officer", Notes = "Executive leadership" },
            new Employee { Id = 30, DisplayOrder = 29, Name = "Beatrice Potter", Email = "beatrice.potter@company.com", Age = 25, Department = "IT", IsActive = true, HireDate = new DateTime(2023, 1, 9), Salary = 54000, Position = "Junior Developer", Notes = "Fresh talent" }
        };
    }

    private void ConfigureColumns()
    {
        columns = new List<GridColumn<Employee>>
        {
            // ID Column (readonly)
            new GridColumn<Employee>
            {
                HeaderText = "ID",
                Sortable = true,
                SortExpression = e => e.Id,
                DisplayTemplate = employee => @<span>@employee.Id</span>,
                EditTemplate = employee => @<input type="text" class="grid-input readonly" value="@employee.Id" readonly />
            },

            // Name Column (text input)
            new GridColumn<Employee>
            {
                HeaderText = "Name",
                Sortable = true,
                SortExpression = e => e.Name,
                DisplayTemplate = employee => @<span>@employee.Name</span>,
                EditTemplate = employee => @<input type="text" class="grid-input" @bind="employee.Name" placeholder="Enter name" />
            },

            // Email Column (email input)
            new GridColumn<Employee>
            {
                HeaderText = "Email",
                Sortable = true,
                SortExpression = e => e.Email,
                DisplayTemplate = employee => @<span>@employee.Email</span>,
                EditTemplate = employee => @<input type="email" class="grid-input" @bind="employee.Email" placeholder="Enter email" />
            },

            // Age Column (number input)
            new GridColumn<Employee>
            {
                HeaderText = "Age",
                Sortable = true,
                SortExpression = e => e.Age,
                DisplayTemplate = employee => @<span>@employee.Age</span>,
                EditTemplate = employee => @<input type="number" class="grid-input" @bind="employee.Age" min="18" max="100" placeholder="Age" />
            },

            // Department Column (select dropdown)
            new GridColumn<Employee>
            {
                HeaderText = "Department",
                Sortable = true,
                SortExpression = e => e.Department,
                DisplayTemplate = employee => @<span>@employee.Department</span>,
                EditTemplate = employee =>
                    @<select class="grid-select" @bind="employee.Department">
                        <option value="">Select...</option>
                        <option value="IT">IT</option>
                        <option value="HR">HR</option>
                        <option value="Finance">Finance</option>
                        <option value="Marketing">Marketing</option>
                        <option value="Sales">Sales</option>
                    </select>
            },

            // Position Column (text input)
            new GridColumn<Employee>
            {
                HeaderText = "Position",
                Sortable = true,
                SortExpression = e => e.Position,
                DisplayTemplate = employee => @<span>@employee.Position</span>,
                EditTemplate = employee => @<input type="text" class="grid-input" @bind="employee.Position" placeholder="Position" />
            },

            // Salary Column (number input with currency)
            new GridColumn<Employee>
            {
                HeaderText = "Salary",
                Sortable = true,
                SortExpression = e => e.Salary,
                DisplayTemplate = employee => @<span>$@employee.Salary.ToString("N0")</span>,
                EditTemplate = employee => @<input type="number" class="grid-input" @bind="employee.Salary" step="1000" min="0" placeholder="Salary" />
            },

            // Hire Date Column (date input)
            new GridColumn<Employee>
            {
                HeaderText = "Hire Date",
                Sortable = true,
                SortExpression = e => e.HireDate ?? DateTime.MinValue,
                DisplayTemplate = employee => @<span>@(employee.HireDate?.ToString("yyyy-MM-dd") ?? "N/A")</span>,
                EditTemplate = employee => @<input type="date" class="grid-input" @bind="employee.HireDate" />
            },

            // Active Status Column (checkbox)
            new GridColumn<Employee>
            {
                HeaderText = "Active",
                Sortable = true,
                SortExpression = e => e.IsActive,
                DisplayTemplate = employee => @<span class="@(employee.IsActive ? "badge-active" : "badge-inactive")">@(employee.IsActive ? "Yes" : "No")</span>,
                EditTemplate = employee =>
                    @<div class="checkbox-container">
                        <input type="checkbox" class="grid-checkbox" id="active-@employee.Id" @bind="employee.IsActive" />
                        <label for="active-@employee.Id">Active</label>
                    </div>
            },

            // Notes Column (textarea)
            new GridColumn<Employee>
            {
                HeaderText = "Notes",
                Sortable = false,
                DisplayTemplate = employee => @<span class="notes-text">@employee.Notes</span>,
                EditTemplate = employee => @<textarea class="grid-textarea" @bind="employee.Notes" rows="2" placeholder="Enter notes"></textarea>
            }
        };
    }

    private Employee CreateNewEmployee()
    {
        return new Employee
        {
            Id = nextId++,
            HireDate = DateTime.Today,
            IsActive = true
        };
    }

    private void HandleItemSaved(Employee employee)
    {
        Console.WriteLine($"Employee {employee.Name} saved");
    }

    private void HandleItemDeleted(Employee employee)
    {
        Console.WriteLine($"Employee {employee.Name} deleted");
    }

    private void HandleItemAdded(Employee employee)
    {
        Console.WriteLine($"Employee {employee.Name} added");
    }

    private Employee CloneEmployee(Employee employee)
    {
        return employee.Clone();
    }
}

<style>
    .page-container {
        max-width: 1600px;
        margin: 0 auto;
        padding: 20px;
    }

    h1 {
        color: #333;
        margin-bottom: 10px;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    .description {
        color: #666;
        margin-bottom: 20px;
        font-size: 14px;
    }

    /* Input Styling */
    ::deep .grid-input,
    ::deep .grid-select,
    ::deep .grid-textarea {
        width: 100%;
        padding: 6px 10px;
        border: 1px solid #ced4da;
        border-radius: 4px;
        font-size: 14px;
        box-sizing: border-box;
        transition: border-color 0.15s ease-in-out;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        min-width: 0;
        max-width: 100%;
    }

    ::deep .grid-input:focus,
    ::deep .grid-select:focus,
    ::deep .grid-textarea:focus {
        outline: none;
        border-color: #80bdff;
        box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
    }

    ::deep .grid-input.readonly {
        background-color: #e9ecef;
        cursor: not-allowed;
    }

    ::deep .grid-checkbox {
        margin-right: 8px;
        cursor: pointer;
        width: 18px;
        height: 18px;
    }

    ::deep .checkbox-container {
        display: flex;
        align-items: center;
        white-space: nowrap;
    }

    ::deep .checkbox-container label {
        cursor: pointer;
        user-select: none;
        margin: 0;
    }

    ::deep .grid-textarea {
        resize: vertical;
        min-height: 40px;
        white-space: normal;
    }

    ::deep .badge-active {
        background-color: #28a745;
        color: white;
        padding: 4px 12px;
        border-radius: 12px;
        font-size: 12px;
        font-weight: 500;
    }

    ::deep .badge-inactive {
        background-color: #dc3545;
        color: white;
        padding: 4px 12px;
        border-radius: 12px;
        font-size: 12px;
        font-weight: 500;
    }

    ::deep .notes-text {
        display: block;
        max-width: 200px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }
</style>
